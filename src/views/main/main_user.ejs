<style>
    .title {
        background-color: rgba(0,0,0,0);
        padding: 10px;
        display: flex;
        justify-content: space-between;
    }
    .plus_sign:hover {
        cursor: pointer;
        color: var(--color-indigo);
    }
    .today_goal {
        padding: 10px 20px;
        border: 3px var(--color-deepgreen) solid;
        border-radius: 10px;
        width: 100%;
        height: 20%;
        min-height: 200px;
        justify-content: center;
    }
    .today_goal .today_write {
        padding: 10px 20px;
        background-color: var(--color-indigo);
        width: 80%;
    }
    .today_goal .today_none {
        color: var(--color-indigo);
        font-size: 1.4rem;
        display: flex;
        min-height: 180px;
        height: 20%;
        justify-content: center;
        align-items: center;
    }
    div .swiper-slide {
        background-size: 100% 100%;
        height: 85%;
        transition: transform 0.6s;
        transform-style: preserve-3d;
    }
    div .swiper-slide .flip-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.6s;
        transform-style: preserve-3d;
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
    }
    div .swiper-slide:hover .flip-inner {
        transform: rotateY(180deg);
    }
    .flip-inner .flip-front,
    .flip-inner .flip-back {
        position: absolute;
        width: 100%;
        height: 100%;
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
    }
    .flip-front {
        background-size: 100% 100%;
    }
    .flip-back {
        transform: rotateY(180deg);
    }
    .form_list_input input,textarea {
        padding: 0 1em; 
        border: 0;
        height: 38px;
        width: 100%;
        border-radius: 30px;
    }
    .form_list_input input:focus {
        outline: none;
    }
    .form_list_input input::placeholder {
        font-weight: 300;
        color: #aaa;
    }
</style>
<script>
    function todayWrite(){
        if ( $("#today_write").hasClass("d-none") ) $("#today_write").removeClass("d-none").addClass("d-flex");
        else $("#today_write").removeClass("d-flex").addClass("d-none");
    }
    function goalWrite(){
        var form = document.getElementById("form_goal");
        var data = {
            title: form.title.value,
            detail: form.detail.value,
            mode: form.mode.value
        }

        window.API.post(`${URL}/goal/write`, data).then((result) => {
            if ( result.return ) {
                console.log( result.goal );
                alert("목표 등록");
            } else {
                window.MSG.error("목표 등록 실패", result.msg);
                form.reset();
            }
        });
    }
</script>

<div class="title">
    <div><h1> 오늘의 챌린지 ✨ </h1></div>
    <div><h1> <span class="glyphicons glyphicons-plus-sign plus_sign" onclick="todayWrite();"></span> </h1></div>
</div>
<div class="today_goal">
    <div id="today_write" class="d-none" style="width: 100%; justify-content: center; padding: 10px 0;">
        <div class="today_write">
            <form class="form_list_input" id="form_goal">
                <input type="radio" name="mode" value="sport">스포츠
                <input type="radio" name="mode" value="hobby">취미
                <input type="text" name="title" placeholder="제목">
                <textarea name="detail" placeholder="상세내용" rows="3"></textarea>
                <button type="button" onclick="goalWrite();">작성</button>
            </form>
        </div>
    </div>
    <div class="swiper">
        <% if ( daily.length != 0 ) { %>
        <div class="swiper-wrapper">
            <% daily.forEach((goal) => { %>
                <div class="swiper-slide">
                    <div class="flip-inner">
                        <div class="flip-front" style="background-image: url('/static/img/<%=goal.mode%>.png');">
                            <h5><%=goal.title%></h5>
                        </div>
                        <div class="flip-back">
                            <div class="swiper-content swiper-content-detail">
                                <h5><%=goal.title%></h5>
                                <img src="/static/img/<%=goal.mode%>.png" width="100" height="100">
                                <p><%=goal.detail%></p>
                            </div>
                        </div>

                    </div>
                </div>
            <% }) %>
        </div>
            <!-- If we need navigation buttons -->
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
        
        <!-- If we need scrollbar -->
        <div class="swiper-scrollbar"></div>
        <% } else { %>
        <div class="today_none">
            오늘의 목표가 없습니다. 목표를 등록해주세요.
        </div>
        <% } %>
    </div>
</div>

<script>
    $(document).ready(() => {
        const swiper = new Swiper('.swiper', {
            // Optional parameters
            direction: 'horizontal',
            loop: true,
            slidesPerView: 3,
            spaceBetween: 30,
            
            centeredSlides: true,
            grapCursor: true,
            pagination: {
                el: '.swiper-pagination',
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            scrollbar: {
                el: '.swiper-scrollbar',
            },
        });
    })
</script>